@*
    Versión: 1.0
    Descripción: Subir.cshtml Representada para gestionar asignacion trabajo
    Para el caso de uso: Gestionar Asginación Trabajo

    Fecha de creación: [07/08/2023]
    Creado por: [DJFN]

    Última modificación: [11/11/2023]
    Modificado por: [JFSV]
*@


@model SistemaArtemis.Models.Archivos
@{
    //ViewBag.Title = "Subir";
    Layout = "~/Views/Shared/_TecnicoLayout.cshtml";
    var problemas = ViewBag.Prob as List<SistemaArtemis.Models.Problema>;
    var idtecnico = Session["Id_Tecnico"];
}

<!-- Asegúrate de incluir jQuery en tu página -->
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

<div class="card">
    <div class="card-header py-3 bg-second-primary">
        <h6 class="m-0 font-weight-bold text-white">Postular al servicio - Envía tu Cotización </h6>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                   @* <label for="documento">Envía tu Cotización:</label>*@
                </div>
                <div class="panel-body">
                    <form action="@Url.Action("SubirArchivo","Archivo")" method="post" enctype="multipart/form-data">
                        <div class="form-group">
                            <label>Nombre del archivo:</label>
                            <input class="form-control" name="Nombre" placeholder="Cotizacion " type="text" autocomplete="off" id="nombreArchivo" />
                        </div>
                        <div class="form-group">
                            <label>Precio final cotización:</label>
                            <input class="form-control" name="Precio" type="number" placeholder="S/. " autocomplete="off" id="preciocotiza" />
                        </div>
                        <div class="form-group">
                            <label>Archivo:</label>
                            <input name="Archivo" type="file" id="Documento" accept=".pdf,.doc,.docx" />
                        </div>
                        <div>
                            @foreach (var problema in problemas)
                            {
                                <input type="hidden" name="Id_Problema" value="@problema.Id_Problema" />
                            }
                        </div>
                        <div class="form-group">
                            <input type="hidden" name="Id_Tecnico" value="@idtecnico" />
                            @*@Html.HiddenFor(x => x.Id_Tecnico, new { @Value = idtecnico })*@
                        </div>

                        <button class="btn btn-success" id="btnSubirArchivo" disabled>Subir Archivo</button>
                        <a class="btn btn-warning" href="@Url.Action("List","Servicio")">Volver</a>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        // Manejar el evento input para el campo de nombre del archivo
        $("#nombreArchivo").on("input", function () {
            validarBotonSubirArchivo();
        });

        // Manejar el evento input para el campo de archivo
        $("#Documento").on("input", function () {
            validarBotonSubirArchivo();
        });

        function validarBotonSubirArchivo() {
            // Obtener el valor del nombre del archivo y del campo de archivo
            var nombreArchivo = $("#nombreArchivo").val();
            var archivo = $("#Documento").val();

            // Habilitar o deshabilitar el botón en consecuencia
            if (nombreArchivo.length > 0 && archivo.length > 0) {
                $("#btnSubirArchivo").prop("disabled", false);
            } else {
                $("#btnSubirArchivo").prop("disabled", true);
            }
        }
    });
</script>
